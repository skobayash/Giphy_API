<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giphy API</title>
    
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    
    <link rel="stylesheet" href="assets/css/styles.css" >
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
    #gifblk {
        float: left;
    }
    
    </style>
    
</head>
    <body>
        <!-- Navbar -->
        <div id="navbar" class="navbar">
            <div class="nav-left"><h2>Giphy Maker</h2></div>
            <div class="nav-right">
                <form>
                    <input id="new-topic" type="text">
                    <button type="submit" id="button-input">Add button</button>
                </form>
            </div> 
            <hr>
            <div id="btn-row">
                <button type="submit"></button>
            </div>
        </div>
                
        <!-- Main Content -->
    
        <div class="container">
           
                <div id="giftainer"></div>
                    
        </div>



<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script type="text/javascript">


    

var topics = ["simpsons", "thad castle", "catbug", "puppycat", "bread cat", "bruce lee"];
var clicked = false;

var createButton = function() {
    $("#btn-row").empty(); 
    for (var i = 0; i < topics.length; i++) {
        console.log(topics[i]);
            var newButton = $("<button>");
            $("#btn-row").append(newButton);
            newButton.attr("data-content", topics[i]);
            newButton.addClass("button");
            newButton.text(topics[i]);
    }
}

// Takes the value from the input and adds it into the array
$("#button-input").on("click", function(event){
    event.preventDefault();
    var newTopic = $("#new-topic").val().trim();
    topics.push(newTopic);
    createButton(); 
})    

createButton();


$(document).on("click", ".button", function(){
    var content = $(this).attr("data-content");
    
    var queryURL = "https://api.giphy.com/v1/gifs/search?q=" 
    + content + "&api_key=870GYH5jPzsxItnRImQEmSIaqCr71Mcc&limit=10";

    $("#giftainer").empty();

    $.ajax({
        url: queryURL,
        method: "GET"
    }).then(function(response) {
        var results = response.data;
        var giftainer = $("#giftainer");
        var gifDiv = $("<div class='item'>");
        
        for(var i = 0; i < results.length; i++ ) {

            var movingLink = results[i].images.fixed_height.url;
            var stillLink = results[i].images.fixed_height_still.url;
            // console.log(movingLink)
            // console.log(stillLink)

            
            var rating = results[i].rating;
            var p = $("<h6>").append("Rated " + rating);



            var gifImg = $("<img>");
            gifImg.addClass("clickMe");


            gifImg.attr("src", movingLink);
            gifImg.attr("data-state", 'still');
            gifImg.attr("data-animate", movingLink);
            gifImg.attr('data-still', stillLink);

            gifDiv.append(gifImg);
            gifDiv.append(p);
            giftainer.prepend(gifDiv);                

        }
    });
});

$(document).on('click', '.clickMe', function(){

      var state = $(this).attr("data-state");
      if (state === "still") {
        $(this).attr("src", $(this).attr("data-animate"));
        $(this).attr("data-state", "animate");
      } else {
        $(this).attr("src", $(this).attr("data-still"));
        $(this).attr("data-state", "still");
      }
    })

    



    </script>

    </body>
</html>  
                    
